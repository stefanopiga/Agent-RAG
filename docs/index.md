# Documentation Index - docling-rag-agent

> **Primary entry point for AI-assisted development**
>
> This documentation was generated by BMad Method document-project workflow on 2025-11-24 using exhaustive scan mode.

## Project Overview

**docling-rag-agent** Ã¨ un sistema RAG (Retrieval Augmented Generation) backend che fornisce accesso conversazionale a knowledge base documentali tramite Streamlit UI e MCP Server.

- **Type:** Monolith - Backend RAG Agent
- **Language:** Python 3.11
- **Architecture:** Service-Oriented RAG
- **Primary Tech:** PydanticAI + Streamlit + Docling + PostgreSQL/PGVector

## Quick Reference

| Aspect                  | Details                                         |
| ----------------------- | ----------------------------------------------- |
| **Framework**           | PydanticAI 0.7.4+ (agent), Streamlit 1.31+ (UI) |
| **Document Processing** | Docling 2.55+ (multi-format support)            |
| **Vector Database**     | PostgreSQL + PGVector (Supabase hosted)         |
| **LLM**                 | OpenAI GPT-4o-mini                              |
| **Embeddings**          | text-embedding-3-small (1536 dims)              |
| **Entry Points**        | `app.py` (Streamlit), `mcp_server.py` (MCP)     |
| **Package Manager**     | UV                                              |
| **Deployment**          | Docker + Docker Compose                         |

## Generated Documentation

### ğŸ“‹ Core Documentation

#### [Project Overview](./project-overview.md)

Executive summary del progetto con features, use cases, tech stack, e roadmap.

**Quando usarlo:** Per overview rapido del progetto, onboarding nuovi membri, presentazioni.

**Contiene:**

- Project description & key features
- Use cases & applications
- Quick stats & performance characteristics
- Roadmap & limitations
- Credits & resources

#### [Architecture](./architecture.md)

Documentazione architetturale completa con layer breakdown, component descriptions, e data flows.

**Quando usarlo:** Per comprendere design decisions, planning refactoring, designing new features.

**Contiene:**

- Executive summary
- Complete tech stack table
- Layered architecture diagrams
- Component responsibilities
- Data flow diagrams (ingestion, query)
- Deployment architecture
- Security architecture
- Testing & monitoring strategy

### ğŸ” Technical Documentation

#### [API & Data Analysis](./api-and-data-analysis.md)

Analisi dettagliata di API/services, ingestion pipeline, database schema.

**Quando usarlo:** Per implementare nuove features, debugging, database schema changes.

**Contiene:**

- **Core Services:** RAG service + PydanticAI agent wrapper
- **Ingestion Pipeline:** DocumentIngestionPipeline, embedder, chunker
- **Database Schema:** PostgreSQL tables (documents, chunks), indexes, functions
- **Data Models:** Pydantic models per validazione
- **Utilities:** Connection pooling, providers

#### [Source Tree Analysis](./source-tree-analysis.md)

Annotated source tree con spiegazioni directory, entry points, e integration points.

**Quando usarlo:** Per navigare codebase, capire module organization, trovare file specifici.

**Contiene:**

- Annotated directory tree
- Critical directories explained (`core/`, `ingestion/`, `utils/`, `sql/`)
- Entry points (Streamlit, MCP, Ingestion CLI)
- Data flow summary
- Architectural patterns
- Key integration points

### ğŸ› ï¸ Development & Operations

#### [Development Guide](./development-guide.md)

Guida completa per setup development, workflow, testing, e deployment.

**Quando usarlo:** Per setup locale, running tests, deployment Docker, troubleshooting.

**Contiene:**

- Prerequisites & system requirements
- Quick start (installation, env config, database setup)
- Development workflow (testing, linting, commands)
- Database operations
- Docker deployment
- Production considerations
- Troubleshooting common issues
- Contributing workflow

#### [Coding Standards](./coding-standards.md)

Standard di codice completi per il progetto, basati sulle pratiche consolidate nel codice esistente.

**Quando usarlo:** Per scrivere codice conforme agli standard, code review, onboarding nuovi sviluppatori.

**Contiene:**

- Python Style Guide (formattazione, import, type hints)
- Naming Conventions (file, codice, database)
- Documentation Standards (docstrings, commenti)
- Error Handling (graceful degradation, exception handling)
- Logging Patterns (structured logging, livelli)
- Async/Await Patterns (quando usare, context managers)
- Testing Standards (organizzazione, naming, coverage)
- Observability Patterns (LangFuse, Prometheus)
- Code Organization (module structure, separation of concerns)
- Performance Considerations (resource management, caching)
- Security Best Practices (secrets, input validation)
- Configuration Management (env vars, config classes)
- Code Review Checklist
- Tools and Linting (Ruff, MyPy, Black)

#### [Testing Strategy](./testing-strategy.md)

Strategia di testing completa con TDD, organizzazione rigorosa dei test, e integrazione CI/CD.

**Quando usarlo:** Per scrivere test, configurare test infrastructure, implementare RAGAS evaluation.

**Contiene:**

- Test-Driven Development (TDD) workflow Red-Green-Refactor
- Test Organization (unit/integration/e2e/fixtures)
- Unit Testing (pattern AAA, mocking, async testing)
- Integration Testing (database, HTTP endpoints, MCP server)
- End-to-End Testing (Playwright per Streamlit)
- RAGAS Evaluation (metriche, thresholds, LangFuse integration)
- Test Configuration (pytest, coverage, markers)
- CI/CD Integration (GitHub Actions workflow)
- Test Best Practices (isolamento, gestione dati, error testing)
- Test Maintenance (documentazione, refactoring)
- Testing Checklist

#### [Unified Project Structure](./unified-project-structure.md) â­ **NEW**

Struttura directory standardizzata e unificata per il progetto, con regole rigorose per organizzazione e manutenzione.

**Quando usarlo:** Per capire dove posizionare nuovi file, validare struttura esistente, refactoring organizzazione.

**Contiene:**

- Root Directory Structure (file autorizzati, directory autorizzate)
- Module Organization by Responsibility (core, docling_mcp, ingestion, utils, api)
- Testing Infrastructure Organization (tests/unit, tests/integration, tests/e2e)
- Scripts Organization (scripts/verification, scripts/debug)
- Documentation Organization (docs/, guide/)
- Epic to Directory Mapping (quale epic usa quale directory)
- File Naming Conventions (Python, test, config, documentation)
- Directory Naming Conventions (modules, tests, scripts)
- Prohibited Patterns (file sparsi, directory temporanee)
- Migration Rules (come spostare file, aggiungere nuovi file)
- Validation Checklist (verifica struttura corretta)
- Best Practices (aggiungere moduli, refactoring, manutenzione)

### ğŸ“Š Additional Resources

#### [README.md](../README.md)

User-facing documentation con complete features explanation, deployment instructions, API reference.

**Quando usarlo:** Per end-user documentation, deployment guide, API usage examples.

**Caratteristiche:**

- 473 lines di documentazione completa
- Detailed feature descriptions
- Docker deployment guide
- Source filtering examples
- API reference

#### [Guide Progetto](../guide/index.md)

Guide dettagliate per sviluppo e troubleshooting.

**Quando usarlo:** Per pattern avanzati, troubleshooting MCP, testing PydanticAI.

**Contiene:**

- [Guida allo Sviluppo](../guide/development-guide.md) - Pattern FastMCP, testing, walkthrough implementazione
- [Guida al Troubleshooting](../guide/troubleshooting-guide.md) - Configurazione MCP, problemi comuni, script verifica

### ğŸ”¬ Deep-Dive Documentation

Detailed exhaustive analysis of specific areas:

- [Ingestion Pipeline Deep-Dive](./deep-dive-ingestion.md) - Analysis of `ingestion/` (ingest, chunker, embedder)
- [MCP Server Deep-Dive](./deep-dive-mcp.md) - Analysis of `mcp_server.py` and `core/rag_service.py`
- [Refactoring Opportunities](./refactoring-opportunities.md) - Analysis of Monolith structure and migration plan to Microservices

## Project Structure Quick Map

```
docling-rag-agent/
â”œâ”€â”€ core/                   # â†’ See: api-and-data-analysis.md Â§ Core Services
â”‚   â”œâ”€â”€ agent.py           # PydanticAI agent wrapper
â”‚   â””â”€â”€ rag_service.py     # Pure RAG business logic
â”‚
â”œâ”€â”€ ingestion/              # â†’ See: api-and-data-analysis.md Â§ Ingestion Pipeline
â”‚   â”œâ”€â”€ ingest.py          # Main orchestration pipeline
â”‚   â”œâ”€â”€ chunker.py         # HybridChunker + SimpleChunker
â”‚   â””â”€â”€ embedder.py        # OpenAI embeddings with caching
â”‚
â”œâ”€â”€ utils/                  # â†’ See: api-and-data-analysis.md Â§ Utilities
â”‚   â”œâ”€â”€ db_utils.py        # AsyncPG connection pooling
â”‚   â”œâ”€â”€ models.py          # Pydantic data models
â”‚   â””â”€â”€ providers.py       # OpenAI provider config
â”‚
â”œâ”€â”€ sql/                    # â†’ See: api-and-data-analysis.md Â§ Database Schema
â”‚   â”œâ”€â”€ schema.sql         # PostgreSQL + PGVector schema
â”‚   â””â”€â”€ removeDocuments.sql # Cleanup script
â”‚
â”œâ”€â”€ app.py                  # â†’ See: source-tree-analysis.md Â§ Entry Points
â”œâ”€â”€ mcp_server.py           # â†’ See: source-tree-analysis.md Â§ Entry Points
â”‚
â””â”€â”€ docs/                   # ğŸ‘ˆ You are here
    â”œâ”€â”€ index.md            # This file
    â”œâ”€â”€ project-overview.md
    â”œâ”€â”€ architecture.md
    â”œâ”€â”€ api-and-data-analysis.md
    â”œâ”€â”€ source-tree-analysis.md
    â””â”€â”€ development-guide.md
```

## Common Tasks - Quick Links

### For Developers

**Starting Development:**

1. Read: [Development Guide Â§ Quick Start](./development-guide.md#quick-start)
2. Setup: Follow installation steps
3. Reference: [Source Tree Analysis](./source-tree-analysis.md) for navigation

**Implementing New Features:**

1. Understand: [Architecture Â§ Component Architecture](./architecture.md#component-architecture)
2. Check Structure: [Unified Project Structure](./unified-project-structure.md) for file placement
3. Follow: [Coding Standards](./coding-standards.md) for code style and patterns
4. Write Tests: [Testing Strategy](./testing-strategy.md) for TDD approach
5. Analyze: [API & Data Analysis](./api-and-data-analysis.md) for API patterns
6. Reference: [Source Tree](./source-tree-analysis.md) for integration points

**Database Changes:**

1. Schema: [API & Data Analysis Â§ Database Schema](./api-and-data-analysis.md#database-schema-analysis-sql)
2. Migrations: Edit `sql/schema.sql`
3. Testing: [Development Guide Â§ Database Operations](./development-guide.md#database-operations)

**Troubleshooting:**

1. Check: [Development Guide Â§ Troubleshooting](./development-guide.md#troubleshooting)
2. Logs: Enable `DEBUG_MODE=true` in `.env`
3. Database: Review connection pool stats

### For DevOps

**Deployment:**

1. Docker: [Development Guide Â§ Docker Deployment](./development-guide.md#docker-deployment)
2. Architecture: [Architecture Â§ Deployment Architecture](./architecture.md#deployment-architecture)
3. Environment: Configure `.env` variables

**Monitoring:**

1. Metrics: [Architecture Â§ Monitoring & Observability](./architecture.md#monitoring--observability)
2. Health Checks: Streamlit `/_stcore/health`
3. Database: PostgreSQL query logs

**Scaling:**

1. Strategy: [Architecture Â§ Scalability Considerations](./architecture.md#scalability-considerations)
2. Connection Pool: Adjust `min_size` / `max_size` in `db_utils.py`
3. Vector Index: Tune IVFFlat `lists` parameter

### For Data Scientists

**Ingestion Pipeline:**

1. Overview: [API & Data Analysis Â§ Ingestion Pipeline](./api-and-data-analysis.md#document-ingestion-ingestioningestpy)
2. Chunking: [API & Data Analysis Â§ Document Chunking](./api-and-data-analysis.md#document-chunking-ingestionchunkerpy)
3. Embeddings: [API & Data Analysis Â§ Embedding Generation](./api-and-data-analysis.md#embedding-generation-ingestionembedderpy)

**Model Configuration:**

1. LLM Selection: Edit `LLM_CHOICE` in `.env`
2. Embedding Model: Edit `EMBEDDING_MODEL` in `.env`
3. Chunking Config: `IngestionConfig` in `ingestion/ingest.py`

**Performance Tuning:**

1. Batch Size: `embedder.py` â†’ `batch_size` parameter
2. Chunk Size: `--chunk-size` CLI argument
3. Token Limit: `ChunkingConfig.max_tokens`

## Navigation Tips

### By Task Type

**Planning New Feature:**

```
1. architecture.md â†’ Understand system design
2. api-and-data-analysis.md â†’ Review existing APIs
3. source-tree-analysis.md â†’ Find relevant modules
```

**Fixing Bug:**

```
1. source-tree-analysis.md â†’ Locate affected component
2. api-and-data-analysis.md â†’ Understand component logic
3. development-guide.md â†’ Setup debug environment
```

**Onboarding:**

```
1. project-overview.md â†’ Get high-level understanding
2. development-guide.md Â§ Quick Start â†’ Setup environment
3. coding-standards.md â†’ Learn code style and conventions
4. testing-strategy.md â†’ Understand testing approach
5. architecture.md â†’ Dive into technical details
```

**Refactoring:**

```
1. architecture.md â†’ Current design patterns
2. api-and-data-analysis.md â†’ Component dependencies
3. source-tree-analysis.md â†’ Module organization
```

## Documentation Metadata

- **Generated By:** BMad Method - document-project workflow
- **Scan Mode:** Exhaustive (complete file reading)
- **Scan Date:** 2025-11-24
- **Project Type:** Backend (Python RAG Agent)
- **Repository Type:** Monolith
- **Total Documents:** 6 (generated) + 2 (existing)
- **Coverage:** Comprehensive (API, Data, Architecture, Dev Guide)

## Next Steps

### For AI Development

Point AI assistants to this index when:

- Planning brownfield PRD: `docs/index.md` + `docs/architecture.md`
- Implementing features: `docs/api-and-data-analysis.md` + relevant sections
- Debugging issues: `docs/source-tree-analysis.md` + `docs/development-guide.md`

### For Human Developers

Bookmark questa pagina e:

1. Start with [Project Overview](./project-overview.md) for context
2. Reference [Architecture](./architecture.md) for design decisions
3. Use [Development Guide](./development-guide.md) for daily workflows

### Updating Documentation

When making significant changes:

1. Update relevant `.md` files in `docs/`
2. Regenerate if structure changes: Re-run `document-project` workflow
3. Keep `index.md` synchronized with new documents

---

**Happy Building! ğŸš€**

For questions or issues, refer to [Development Guide Â§ Troubleshooting](./development-guide.md#troubleshooting).
